<!DOCTYPE html>

<html lang="en">
<head>

    <meta charset="UTF-8">

    <meta name="viewport" 

          content="width=device-width, initial-scale=1.0">

    <title>Employee Management System</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

</head>



<body>

<header>

    <nav class="navbar navbar-expand-lg bg-body-tertiary">

  <div class="container-fluid">

    <a class="navbar-brand" href="#">Navbar</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">

      <span class="navbar-toggler-icon"></span>

    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">

      <ul class="navbar-nav me-auto mb-2 mb-lg-0">

        <li class="nav-item">

          <a class="nav-link active" aria-current="page" href="#">Home</a>

        </li>

        

      </ul>

      

    </div>

  </div>

</nav>

</header>

<button type="button" class="btn btn-primary" onclick="triggerAddEmployee()">Add new employee</button>

<table class="table table-striped">

  <thead>

    <tr>

      <th>Employee ID</th>

      <th>name</th>

      <th>DOJ</th>

      <th>status</th>

      <th>Salary</th>

      <th>Action</th>

    </tr>

  </thead>

  <tbody id="listingTable">


  </tbody>

</table>

	<div class="modal" id="addemp">

	<div class="modal-dialog">

	<div class="modal-content">

	<div class="modal-header">Add Employee</div>

	<div class=modal-body">

	<div class="mt-3 mb-3">

	<label for="addEmployeeName" class="form-label">Employee Name</label>

	<input type="text" class="form-control" id="addEmployeeName" placeholder="Enter The Name">

	</div>

	

	<div class="mt-3 mb-3">

	<label for="addEmployeeDoj" class="form-label">Employee DOJ</label>

	<input type="date" class="form-control" id="addEmployeeDoj" placeholder="Enter The Name">

	</div>

	

	<div class="mt-3 mb-3">

	<label for="addEmployeeStatus" class="form-label">Employee Status</label>

	<select class="form-control" id="addEmployeeStatus">

	<option>Please set employee status</option>

	<option value="1">Active</option>

	<option value="0">Retired</option>

	</select>

	</div>

	

	<div class="mt-3 mb-3">

	<label for="addEmployeeSalary" class="form-label">Employee Salary</label>

	<input type="text" class="form-control" id="addEmployeeSalary" placeholder="Enter The Salary">

	</div>

	

	<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

	<button type="button" class="btn btn-primary" onclick="triggerSaveEmployee()">Save Employee</button>

	</div>

	</div>

	</div>

	</div>

	

	

	

	<div class="modal" id="editemp">

	<div class="modal-dialog">

	<div class="modal-content">

	<div class="modal-header">edit Employee</div>

	<div class=modal-body">

	<div class="mt-3 mb-3">

	<label for="editEmployeeName" class="form-label">Employee Name</label>

	<input type="text" class="form-control" id="editEmployeeName" placeholder="Enter The Name">

	</div>

	

	<div class="mt-3 mb-3">

	<label for="editEmployeeDoj" class="form-label">Employee DOJ</label>

	<input type="date" class="form-control" id="editEmployeeDoj" placeholder="Enter The Name">

	</div>

	

	<div class="mt-3 mb-3">

	<label for="editEmployeeStatus" class="form-label">Employee Status</label>

	<select class="form-control" id="editEmployeeStatus">

	<option>Please set employee status</option>

	<option value="1">Active</option>

	<option value="0">Retired</option>

	</select>

	</div>

	

	<div class="mt-3 mb-3">

	<label for="editEmployeeSalary" class="form-label">Employee Salary</label>

	<input type="text" class="form-control" id="editEmployeeSalary" placeholder="Enter The Salary">

	</div>
    <input type="hidden" id="editEmployeeID">
	

	<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

	<button type="button" class="btn btn-primary" onclick="triggerUpdatedEmployee()">Save Employee</button>

	</div>

	</div>

	</div>

	</div>

	

    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.28/dist/sweetalert2.all.min.js"></script>

    <script>
    loadEmployees();
    function loadEmployees(){
    	var html="";
    	$.ajax({
    		type:"get",
    		url:"http://localhost:8082/api/employee",
    		contentType:"application/json",
    		dataType:"json",
    		
    		success:function(data){
    			var html="";
    			for(var i=0;i<data.length;i++){
    				var badge= data[i]['status']==1?"bg-success":"bg-secondary";
    				var status= data[i]['status']==1?"Active":"Retired";
    				html=html+"<tr>"+
    			    "<td>"+data[i]['id']+"</td>"+
    			    "<td>"+data[i]['name']+"</td>"+
    			    "<td>"+data[i]['doj']+"</td>"+
    			    "<td><span class='badge rounded-pill "+badge+"''><span class='text-white'>"+status+"</span></span></td>"+
    			    "<td>"+data[i]['salary']+"</td>"+
    			    "<td>"+
    			    "<i class='bi bi-pencil-square text-primary fs-5' onclick='triggerEditEmployee("+data[i]["id"]+")''></i>"+
    			    "<i class='bi bi-trash2 text-danger fs-5' onclick='triggerDeleteEmployee("+data[i]["id"]+")''></i>"+
    			    "</td>"+
    			    "</tr>";
    			    $("#listingTable").html(html);
    				
    				
    			}
    			$("#listingTable").html(html);
    			
    		},
    		error:function(){
    			Swal.fire({
    				icon: 'error', // or 'success', 'warning', 'info', 'question'
    				  title: 'Oops...',
    				  text: 'Something went wrong!',
    			})
    		}
    	});
    }

    function triggerAddEmployee(){

    	$("#addemp").modal('show');

    }

    

    function triggerSaveEmployee() {
        var name = $("#addEmployeeName").val();
        var doj = $("#addEmployeeDoj").val();
        var status = $("#addEmployeeStatus").val();
        var salary = $("#addEmployeeSalary").val();
        
        $.ajax({
            type: "POST",
            url: "http://localhost:8082/api/employee",
            contentType: "application/json",
            dataType: "json",
            data: JSON.stringify({ "name": name, "doj": doj, "status": status, "salary": salary }),
            success: function() {
                Swal.fire("Saved!", 'Employee has been saved successfully!', 'success');
                loadEmployees(); // Reload the employee list
            },
            error: function() {
                Swal.fire("Error!", 'Something Went Wrong!', 'error');
            }
        });
        
        $("#addemp").modal('hide');
    }
    	
    	


    	
    

    function triggerEditEmployee(id) {
        $.ajax({
            type: "GET",
            url: "http://localhost:8082/api/employee/" + id, // Correctly concatenate the id variable
            contentType: "application/json",
            dataType: "json",
            success: function(data) {
                var date = new Date(data.doj);
                $("#editEmployeeName").val(data.name);
                $("#editEmployeeDoj").val(date.toISOString().substring(0, 10));
                $("#editEmployeeStatus").val(data.status);
                $("#editEmployeeSalary").val(data.salary);
                $("#editEmployeeID").val(data.id);
                $("#editemp").modal('show');

                loadEmployees(); // Reload the employee list
            },
            error: function() {
                Swal.fire("Error!", 'Something Went Wrong!', 'error');
            }
        });
    }

		
		
	

	function triggerUpdatedEmployee(){
		
		var name = $("#editEmployeeName").val();
        var doj = $("#editEmployeeDoj").val();
        var status = $("#editEmployeeStatus").val();
        var salary = $("#editEmployeeSalary").val();
        var id = $("#editEmployeeID").val();
        
        $.ajax({
            type: "put",
            url: "http://localhost:8082/api/employee/" +id,
            contentType: "application/json",
            dataType: "json",
            data: JSON.stringify({ "name": name, "doj": doj, "status": status, "salary": salary }),
            success: function() {
            	Swal.fire("Updated!",'Employee has been updated successfully!', 'success')
                loadEmployees(); // Reload the employee list
            },
            error: function() {
                Swal.fire("Error!", 'Something Went Wrong!', 'error');
            }
        });
        
        $("#editemp").modal('hide');


    }

	function triggerDeleteEmployee(id){

	    Swal.fire({

	    	title:"Are You Sure?",

	    	text:"You cannot reverse this operation",

	    	icon:"warning",

	    	showCancelButton:true,

	    	confirmButtonColor:'#3085d6',

	    	cancelButtonColor:'#d33',

	    	confirmButtonText:"Proceed"

	    }).then((result)=>{

	    	if(result.isConfirmed){
	    		
	    		$.ajax({
	                type: "delete",
	                url: "http://localhost:8082/api/employee/" + id, // Correctly concatenate the id variable
	                contentType: "application/json",
	                dataType: "json",
	                error: function() {
	    	    		Swal.fire("Deleted!",'Employee has been deleted successfully!', 'success')


	                    loadEmployees(); // Reload the employee list
	                },
	                
	            });


	    	}

	    })

	}

    </script>

</body>



</html>